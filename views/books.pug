extends layout

block script
	script(src="https://cdn.tiny.cloud/1/jacjw3m3b4xvz0x2gjtrlkmh0asszi8d1rzzfs62nj8733j1/tinymce/5/tinymce.min.js" referrerpolicy="origin")
	script.
		tinymce.init({
			selector:  '#body',
			menubar: false,
			statusbar: false,
		})

block content
	h1= book.title
	h5 Written by #{author}
	label Genre: #{genre.genre}
	p Description: #{book.description}
	if book.link
		a(href=`${book.link}`,  target="_blank") Discord Link
		br
	hr
	if user
		//- a(href=`/books/request/${book.id}`) Request Access
		if user.userName == book.authorName
			div
				a(href=`/books/modify/${book.id}`) Modify Book
				| 
				a(href='#', id="delete", data-id=`${book.id}`) Delete
				//- a(href=`/books/delete/${book.id}`) Delete
		hr
	h3 Book Chapter
	if !book.pages
		div
			each pg, i in page
				div
					a(href="/books/page/"+pg.id)= pg.chapterName
					| 
					if user
						if user.userName == book.authorName
							span - #{(pg.histories.length)} Pending Approval Requests
	hr
	if user
		//- if user.userName == book.authorName
		h3 Add Page Section
		form(method='POST', action=`/books/${book.id}`)
			div
				label Chapter Name:
				input(type="text", name='chapterName', value=`${(!prevChapter) ? '' : prevChapter}`)
			div
				label Page Number:
				input(type="number", name='pageNumber', value=`${prevPageNumber}`)
			div
				label Content:
				textarea#body(name='body')=prevBody
			div
				button(type="submit") Add Page
				| 
				a(href='/users/profile') Cancel
		//- else
		//- 	a(href=`/`) Back
	//- else
	//- 	a(href=`/`) Back
	script(src='/javascripts/delete_book.js')