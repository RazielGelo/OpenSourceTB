extends layout

block script
	script(src="https://cdn.tiny.cloud/1/jacjw3m3b4xvz0x2gjtrlkmh0asszi8d1rzzfs62nj8733j1/tinymce/5/tinymce.min.js" referrerpolicy="origin")
	script.
		tinymce.init({
			selector:  '#body',
			menubar: false,
			statusbar: false,
		})

block content
	div
		<main>
		<article>
		div.fs-4.p-3
			h2= book.title
			h5 Written by #{author}
			label Genre: #{genre.genre}
			p Description: #{book.description}
			if book.link
				a(href=`${book.link}`,  target="_blank") Author's Link
				br
		hr
		if user
			//- a(href=`/books/request/${book.id}`) Request Access
			if user.userName == book.authorName
				div
					//- a(href=`/books/modify/${book.id}`, class="buttonsmall") Modify Book
					| 
					//- a(href='#', id="delete", data-id=`${book.id}`, class="buttonsmall") Delete Book
					//- a(href=`/books/delete/${book.id}`) Delete
		if user
			//- if user.userName == book.authorName
			div.p-3
				h3 Add Page Section
				form(method='POST', action=`/books/${book.id}`, onsubmit="submitButton.disabled = true; return true;")
					div.fs-5
						label Chapter Name:
						input(type="text", name='chapterName', value=`${(!prevChapter) ? '' : prevChapter}`, class="input")
					div.fs-5
						label Page Number:
						input(type="number", name='pageNumber', value=`${prevPageNumber}`, min=1)
					div.fs-5
						label Content:
						textarea#body(name='body')=prevBody
					div.fs-5
						button(type="submit", class="btn btn-primary color-orange", name="submitButton") Add Page
						| 
						a(href='/users/profile', class="btn btn-primary color-blue") Cancel
				//- else
				//- 	a(href=`/`) Back
			//- else
			//- 	a(href=`/`) Back
		
		</article> 

		<aside class="info1">
		if user
			//- a(href=`/books/request/${book.id}`) Request Access
			if user.userName == book.authorName
				div
					a(href=`/books/modify/${book.id}`, class="btn btn-primary color-orange m-2 fs-4") Modify Book
					| 
					a(href='#', id="delete", data-id=`${book.id}`, class="btn btn-primary color-blue m-2 fs-4") Delete Book
					//- a(href=`/books/delete/${book.id}`) Delete
		
		h3 Book Chapter
		if !book.pages
			div.fs-5
				each pg, i in page
					div
						a(href="/books/page/"+pg.id)= pg.chapterName
						| 
						if user
							if user.userName == book.authorName
								if (pg.histories.length > 0)
									span - #{(pg.histories.length)} Pending Approval Requests
		</aside> 
		</main> 
		script(src='/javascripts/delete_book.js')